<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% block title %}TaggedByBelle{% endblock %}</title>
    <style>
      :root {
        --bg: #0b0f19;          /* deep navy */
        --panel: #0e1422;       /* elevated surfaces */
        --line: #1f2a3b;        /* subtle borders */
        --text: #e6e9ef;        /* primary text */
        --muted: #9aa4b2;       /* secondary text */
        --brand: #e2fb52;       /* electric lime */
        --brand-ink: #0b0f19;   /* brand on light */
        --cta: #7c3aed;         /* accent */
      }
      * { box-sizing: border-box; }
      body {
        margin: 0;
        color: var(--text);
        background:
          radial-gradient(1200px 600px at 10% -10%, rgba(124,58,237,0.15), transparent),
          radial-gradient(900px 500px at 90% 0%, rgba(226,251,82,0.10), transparent),
          linear-gradient(180deg, #0a0e17, var(--bg));
        font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, Noto Sans;
        letter-spacing: .1px;
      }
      .container { max-width: 1180px; margin: 0 auto; padding: 0 1.25rem; }
      header.navbar { position: sticky; top: 0; z-index: 50; border-bottom: 1px solid rgba(255,255,255,0.06); backdrop-filter: saturate(160%) blur(10px); background: rgba(11,15,25,0.6); }
      .nav-inner { height: 68px; display: flex; align-items: center; gap: 1rem; }
      a.brand { display:flex; align-items:center; gap:.6rem; text-decoration:none; color: var(--text); font-weight: 900; font-size: 1.15rem; letter-spacing: .2px; margin-right: auto; }
      .brand-dot { width: 10px; height: 10px; border-radius: 50%; background: var(--brand); box-shadow: 0 0 0 3px rgba(226,251,82,0.2); }
      nav a.link { color: var(--muted); text-decoration: none; padding: .55rem .85rem; border-radius: 10px; transition: all .2s ease; }
      nav a.link:hover { color: var(--text); background: rgba(255,255,255,0.06); }
      a.btn, button.btn { display: inline-flex; align-items:center; gap:.45rem; padding: .55rem .95rem; border-radius: 12px; font-weight: 800; text-decoration: none; cursor: pointer; border: 1px solid transparent; }
      a.btn-primary, button.btn-primary { background: var(--brand); color: var(--brand-ink); border-color: rgba(226,251,82,0.35); box-shadow: 0 10px 30px rgba(226,251,82,0.22); }
      a.btn-primary:hover, button.btn-primary:hover { box-shadow: 0 14px 40px rgba(226,251,82,0.32); transform: translateY(-1px); }
      a.btn-ghost, button.btn-ghost { background: transparent; color: var(--text); border-color: var(--line); }
      a.btn-ghost:hover, button.btn-ghost:hover { background: rgba(255,255,255,0.06); }
      /* Dropdown */
      .menu { position: relative; display:inline-block; }
      .menu-btn { display:inline-flex; align-items:center; gap:.45rem; padding:.55rem .85rem; border-radius:10px; border:1px solid var(--line); background:transparent; color:var(--text); cursor:pointer }
      .menu-btn:hover { background: rgba(255,255,255,0.06); }
      .menu-items { display:none; position:absolute; right:0; margin-top:.5rem; min-width:220px; background:var(--panel); border:1px solid var(--line); border-radius:12px; box-shadow:0 10px 30px rgba(0,0,0,0.35); padding:.35rem; }
      .menu.open .menu-items { display:block; }
      .menu-items a, .menu-items form button { display:block; width:100%; text-align:left; padding:.55rem .7rem; color:var(--text); text-decoration:none; border-radius:8px; background:transparent; border:none; cursor:pointer }
      .menu-items a:hover, .menu-items form button:hover { background: rgba(255,255,255,0.06); }
      .avatar-mini { width: 34px; height: 34px; border-radius: 50%; object-fit: cover; border: 1px solid rgba(255,255,255,0.25); vertical-align: middle; }
      main { padding: 2.2rem 0 3rem; }
      /* Common UI */
      .card { background: var(--panel); border: 1px solid var(--line); border-radius: 16px; box-shadow: 0 8px 28px rgba(0,0,0,0.28); }
      .chip { display:inline-block; border:1px solid var(--line); border-radius:999px; padding:.25rem .65rem; color:var(--muted); }
      .title { font-weight: 900; letter-spacing: .2px; }
      .subtle { color: var(--muted); }
    </style>
  </head>
  <body>
    <header class="navbar">
      <div class="container nav-inner">
        <a href="/" class="brand"><span class="brand-dot"></span> TaggedByBelle</a>
        <nav>
          {% if request.session.get('user_id') %}
            <a class="link" href="{{ '/myorders-admin' if request.session.get('is_admin') else '/myorders' }}">Dashboard</a>
            {% if request.session.get('is_admin') %}
              <a class="link" href="/analytics">Analytics</a>
            {% endif %}
            <a class="link" href="#" title="Notifications">üîî</a>
            <a class="link" href="#" title="Inbox">‚úâÔ∏è</a>
            <div class="menu" id="profileMenu">
              <button class="menu-btn" onclick="toggleMenu('profileMenu')" style="position:relative;border:none;background:none;padding:0">
                {% if request.session.get('avatar_url') %}
                  <img src="{{ request.session.get('avatar_url') }}" alt="Avatar" class="avatar-mini" style="border:none" />
                {% else %}
                  <span class="avatar-mini" style="display:inline-grid;place-items:center;background:#0b1020;border:none">{{ request.session.get('username','U')[0]|upper }}</span>
                {% endif %}
                <span style="position:absolute;right:2px;bottom:2px;width:8px;height:8px;border-radius:50%;background:#22c55e;border:2px solid rgba(11,15,25,.8)"></span>
              </button>
              {% if request.session.get('is_admin') %}<span class="link" style="pointer-events:none;opacity:.85;margin-left:.5rem">‚Ç¨{{ '%.2f'|format(request.session.get('admin_month_earnings', 0.0)) }}</span>{% endif %}
              <div class="menu-items" style="min-width:260px">
                <div style="padding:.65rem;border-bottom:1px solid var(--line);display:flex;gap:.6rem;align-items:center">
                  {% if request.session.get('avatar_url') %}
                    <img src="{{ request.session.get('avatar_url') }}" class="avatar-mini" style="width:42px;height:42px" />
                  {% else %}
                    <span class="avatar-mini" style="display:inline-grid;place-items:center;background:#0b1020;width:42px;height:42px">{{ request.session.get('username','U')[0]|upper }}</span>
                  {% endif %}
                  <div>
                    <div style="font-weight:800">{{ request.session.get('username') }}</div>
                    <div class="subtle">{{ request.session.get('email','') }}</div>
                  </div>
                </div>
                <a href="/profile">Account Settings</a>
                <form method="post" action="/logout">
                  <button type="submit">Log out</button>
                </form>
              </div>
            </div>
          {% else %}
            <a class="btn btn-ghost" href="/login">Login</a>
            <a class="btn btn-primary" href="/signup">Sign Up</a>
          {% endif %}
        </nav>
      </div>
    </header>
    <main class="container">
      {% block content %}{% endblock %}
    </main>
    <script>
      function toggleMenu(id){
        const el = document.getElementById(id);
        el.classList.toggle('open');
        // close others
        document.querySelectorAll('.menu').forEach(m=>{ if(m.id!==id) m.classList.remove('open'); });
      }
      window.addEventListener('click', (e)=>{
        const anyMenu = e.target.closest('.menu');
        if(!anyMenu){ document.querySelectorAll('.menu').forEach(m=>m.classList.remove('open')); }
      });
    </script>
  </body>
  
</html>
